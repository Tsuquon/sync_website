an essential step towards understanding how the brain works is to create a catalogue of brain-cell types. cell-type classification has been transformed by single-cell transcriptomics, which reveals the entire repertoire of expressed genes (the transcriptome) in each of thousands or millions of single cells isolated from a brain region of interest1. but what do these cell types do, and what parts do they play in neuronal circuits? writing in nature, bugeon et al.2 attempt to address these questions by developing an approach to measuring the in vivo activities of transcriptomically defined cell types in the mouse visual cortex. read the paper: a transcriptomic axis predicts state modulation of cortical interneuronssingle-cell transcriptomics has revealed many different groups of cortical neurons1,3,4 — about 95 in the mouse primary visual cortex, for instance3. these groups can be organized in a hierarchical manner on the basis of transcriptomic similarities and differences, forming a four-level structure of classes, subclasses, types and subtypes.unravelling the function of each of these groups requires the ability to distinguish them in living brains and measure their activities over time. this has become possible in the past few years thanks to spatial transcriptomics5–7, in which gene expression is analysed in a brain slice, preserving the spatial location of each cell. spatial transcriptomics can be conducted after in vivo functional studies in the same brain tissue, enabling researchers to assign transcriptomic identities to neurons for which other properties (such as activity or shape) have already been measured8,9.bugeon and colleagues set out to increase the scope of such post hoc spatial transcriptomic profiling, in terms of both the number of cells profiled and the number of genes probed in each cell. to do this, the authors developed a technique called coppafish, which determines the expression of 72 genes simultaneously in individual cells in thin brain sections. this expression profile can then be mapped to existing3 single-cell transcriptomes to decode fine-grained cell identities.the researchers made use of this approach to analyse one class of neuron, gabaergic inhibitory interneurons, in the mouse primary visual cortex. inhibitory interneurons are neurons that send projections to local brain regions, and that typically suppress or shape the activity of excitatory neurons (the neurons that send long-range axon projections to other parts of the brain to convey sensory or behavioural information). there are dozens of inhibitory interneuron subtypes in the cortex, and their functional properties had not been studied in detail. the authors used a technique called calcium imaging (in which intracellular calcium levels act as a proxy for neuronal activity) to record the activity of large populations of these neurons as mice ran on a ball and responded to visual stimuli on a screen. the authors subsequently applied coppafish to the imaged tissue to identify cells in the superficial layers of the cortex (fig. 1). they also performed a series of image-alignment tasks, to ensure that the correlations between the imaging and transcriptomic data for each cell were highly precise. in total, they obtained data for 1,090 interneurons.figure 1 | combining function with gene expression. bugeon et al.2 used imaging approaches to measure the activity of one class of neuron in the visual cortex of the mouse brain, while the animal ran on a ball and responded to visual stimuli on a screen. they subsequently analysed the expression of 72 genes in slices of brain containing the same neurons, using a technique called coppafish. the authors mapped the coppafish profile of each neuron onto existing gene-expression profiles (transcriptome data) for neurons of various identities — this enabled them to assign each of the neurons they had analysed to one of 5 subclasses, 11 types and 35 subtypes (for simplicity, only part of the tree is shown). aligning the activity and coppafish data from each cell enabled the authors to determine how a cell’s classification into a particular transcriptomic subclass, type and subtype related to its activity. neurons exhibited different responses to visual stimuli at subclass level, whereas differences in brain-state-related activity (whether the mouse is running or stationary, for instance) were apparent at subclass, type and subtype levels.the authors assigned these interneurons to 5 subclasses, 11 types and 35 subtypes, many of which had not previously been identified in vivo (such as a subclass named sncg). they then used their data to analyse how each group responded to different visual stimuli and different brain states (that is, states characterized by patterns of activity that drive particular behaviours, such as running or being stationary). they found that the responses of the neurons to various features of the visual stimuli (such as orientation and direction selectivity) differed significantly across subclasses, but not types or subtypes. by contrast, responses to different brain states, as measured by the locomotor activity and pupil size, differed at all three hierarchical levels.bugeon et al. performed a principal component analysis — an approach that reduces the dimensionality of large data sets by identifying their most important features (named principal components). the analysis revealed a single transcriptomic principal component that could predict how the activity of different cell subtypes would be modulated by brain states. this transcriptomic axis correlates with specific physiological properties10 of the cells, such as their membrane time constant (a measure of the time taken for a change in electrical potential across the cell membrane) and rheobase (a measure of neuronal excitability). it also correlates with the level of expression of genes that encode cholinergic receptor proteins, which are involved in modulating neuronal activity. these findings will help us to better understand the complex roles that diverse inhibitory neurons have in circuit function, and how different subtypes of neuron interact with one another.this study begins to address a long-standing question in neuroscience — why are there so many subtypes of inhibitory (and excitatory) neuron in the cortex? although the results are encouraging, there is still a long way to go to fully answer this question and understand whether different cell subtypes all have unique roles. a census of cell types in the brain’s motor cortexbugeon et al. deployed a limited set of visual stimuli while the animal was in one of just a few simple states. future studies that use more diverse and naturalistic visual stimuli, and engage animals in behavioural and learning tasks, are likely to reveal more differences in how neurons respond to visual cues during different phases of behaviour at the type and possibly subtype levels11,12. for instance, it is likely that more-complete analysis of size and contrast tuning in vision will differentiate types within each subclass. this in turn will enable a deeper examination of the relationship between a cell’s behaviour and its gene expression.the approach bugeon et al. have taken is generalizable, and so can be applied to other regions of the brain — researchers should now take the opportunity to extend bugeon and colleagues’ work to all cell types in all layers of the visual cortex. finally, combining their method with in-depth morphological, connectional and physiological characterization of cells1 could enable researchers to explore how cell types interact to form the circuits that govern complex processes such as sensory perception, behaviour and learning.