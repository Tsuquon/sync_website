the central technological appeal of quantum science resides in exploiting quantum effects, such as entanglement, for a variety of applications, including computing, communication and sensing1. the overarching challenge in these fields is to address, control and protect systems of many qubits against decoherence2. against this backdrop, optical photons, naturally robust and easy to manipulate, represent ideal qubit carriers. however, the most successful technique so far for creating photonic entanglement3 is inherently probabilistic and, therefore, subject to severe scalability limitations. here we report the implementation of a deterministic protocol4,5,6 for the creation of photonic entanglement with a single memory atom in a cavity7. we interleave controlled single-photon emissions with tailored atomic qubit rotations to efficiently grow greenberger–horne–zeilinger (ghz) states8 of up to 14 photons and linear cluster states9 of up to 12 photons with a fidelity lower bounded by 76(6)% and 56(4)%, respectively. thanks to a source-to-detection efficiency of 43.18(7)% per photon, we measure these large states about once every minute, which is orders of magnitude faster than in any previous experiment3,10,11,12,13. in the future, this rate could be increased even further, the scheme could be extended to two atoms in a cavity14,15 or several sources could be quantum mechanically coupled16, to generate higher-dimensional cluster states17. overcoming the limitations encountered by probabilistic schemes for photonic entanglement generation, our results may offer a way towards scalable measurement-based quantum computation18,19 and communication20,21.entanglement plays a crucial role in quantum information science. for multiqubit systems, many of the states considered, such as for entanglement purification, secret sharing, quantum error correction, as well as interferometric measurements, belong to the family of graph states9. two prominent examples are ghz and cluster states, which are central ingredients for various measurement-based quantum information protocols19,20,21. one-way quantum computing18, for instance, represents a conceptually appealing alternative to its circuit-based counterpart. instead of carrying out unitary quantum logic gates, computation relies on adaptive single-qubit measurements. this operational easing comes at the price that a multiqubit entangled resource state, a cluster state, needs to be prepared in advance.although multiqubit entanglement has been demonstrated on various platforms3,22,23,24,25,26, only small-scale implementations of measurement-based quantum computing have been realized so far10,27,28. among these platforms, optical photons stand out as qubit carriers, as these suffer negligible decoherence and benefit from crosstalk-free single-qubit addressability and measurement capabilities with off-the-shelf components. however, the most common sources for entangled photons are based on spontaneous parametric down-conversion (spdc). this scheme is inherently probabilistic and thus makes scaling up to larger states an increasingly difficult challenge, even for a moderate number of qubits.to address this issue, deterministic schemes have been proposed4,5,6. these use a single-spin memory qubit that mediates entanglement over a string of sequentially emitted photons. this approach is resource efficient as it permits the generation of in principle arbitrarily many entangled photons from a single device. first experiments along these lines have been performed with quantum dots11,12 demonstrating entanglement of up to three and four qubits, respectively, in a linear cluster state. low photon generation and collection efficiencies, a noisy semiconductor environment or the need for a probabilistic entangling gate were among the biggest obstacles for reaching higher photon numbers. recent experiments with rydberg superatoms13,29 demonstrated ghz states of up to six photons. although the single-emitter strategy could in principle provide a stepping stone for photonic quantum computation, no implementation has demonstrated a performance that beats or even compares to the spdc approach3.here we produce large and high-fidelity photonic graph states of the ghz and cluster type. inspired by the proposals of refs. 4,5,6, which we adapt to our physical system, we use a cavity quantum electrodynamics platform as an efficient photon source30,31,32,33,34 and, for the first time, surpass the state-of-the-art spdc platform. arbitrary single-qubit rotations between photon emissions allow for the flexible preparation of different types of states in a programmable fashion. we generate and detect ghz states of up to 14 photons and linear cluster states of up to 12 photons with genuine multipartite entanglement. in principle, higher-dimensional cluster states can be created by coupling several sources17, for example, by means of optically mediated controlled not gates of the kind demonstrated recently16. by virtue of this feature, so far unique to the atomic cavity quantum electrodynamics platform, our technique supports modular extension towards scalable architectures for one-way quantum computation18,19, as depicted in fig. 1a.a, proposed one-way quantum computing hardware architecture. each source produces a one-dimensional photonic cluster state while at the same time entanglement is distributed across the emitters by ancillary photons being successively reflected off each atom–cavity system16. thus a two-dimensional fabric of photonic cluster states is woven from the individual one-dimensional chains, readily serving as a resource for measurement-based quantum computing. b, experimental setup. a single 87rb atom coupled to a high-finesse cavity emits a stream of entangled photons. various lasers directed onto the atom from the side allow to control the photon emission and manipulate the atomic state to realize the desired protocol. the chain of photons is detected by a polarization-resolving detection setup composed of a pbs and two detectors (det1 and det2). a fast polarization electro-optic modulator switches between two predefined settings such that each individual photon can be measured in either the z or the x basis. a half-wave plate before the pbs rotates the detection basis from x to y and arbitrary superpositions thereof. c, protocol for cluster/ghz state generation divided into three steps. initialization of the atom and first photon emission, cycling process in which the atomic qubit is rotated by θ = 0 or π/2 and a new entangled photon is emitted, and closing of the protocol by emission of a last photon while disentangling the atom from the generated string of photons.our apparatus is shown schematically in fig. 1b. it consists of a single 87rb atom at the centre of a high-finesse optical cavity. a magnetic bias field oriented parallel to the cavity direction defines the quantization axis and gives rise to a zeeman splitting with larmor frequency ωl = 2π × 100 khz. several laser beams propagating perpendicular to the cavity allow for various manipulations, such as state preparation by optical pumping and coherent driving of raman transitions between the hyperfine ground-state manifolds with energy selectivity provided by the zeeman splitting. the cavity serves as an efficient light–matter interface for atom–photon entanglement7 with an optical cooperativity of c ≈ 1.5 (methods). a vacuum-stimulated raman adiabatic passage (vstirap) enables the generation of photons with high indistinguishability stemming from accurate control over their temporal wave function30. photons that are outcoupled from the cavity are analysed with a polarization-resolving detection setup mainly consisting of a polarizing beam splitter (pbs) and a pair of superconducting nanowire single-photon detectors. furthermore, an electro-optic modulator is used for fast selection of the measurement basis by switching between the z basis (right and left circular polarization) and the x basis (horizontal and vertical polarization). when set to the x basis, a half-wave plate can optionally be placed to rotate the detection basis along the equator of the bloch sphere.the experimental protocol for generation of entangled photons in essence consists of a periodic sequence of photon generations interleaved with single-qubit rotations performed on the atom. the sequence is shown in fig. 1c, including the corresponding processes in the atomic-level diagram. we first initialize the atom in the state \(\left|f=2,{m}_{f}=0\right\rangle \) by optical pumping. here we write the atomic state as \(\left|f,{m}_{f}\right\rangle \), in which f denotes the total angular momentum and mf is its projection along the quantization axis. then we apply a control pulse (1.5 μs), which induces the vstirap process generating a photon (300 ns full width at half maximum) entangled in polarization with the atomic state. this process can be written as \(\left|2,0\right\rangle \to \left(\left|1,1\right\rangle \left|r\right\rangle -\left|1,-\,1\right\rangle \left|l\right\rangle \right)/\sqrt{2}\), in which \(\left|r/l\right\rangle \) denotes right/left circular polarization of the photon and \(\{\left|1,1\right\rangle ,\left|1,-\,1\right\rangle \}\) serves as our atomic qubit basis. we then perform a single qubit rotation rθ of angle θ (step 1) on the atom. for cluster states θ = π/2, for ghz states, no rotation is performed, that is, θ = 0. afterwards we transfer the qubit from \(\left|1,\pm 1\right\rangle \) to \(\left|2,\pm 2\right\rangle \) (step 2). both steps 1 and 2 are realized by means of a series of raman pulses with a 790-nm laser (methods). finally, we induce the vstirap process (step 3) by applying a control pulse, which produces a photon (step 4) and takes the atom back to the states \(\left|1,\pm \,1\right\rangle \). steps 2–4 can be summarized by writing \(\left|1,\pm \,1\right\rangle \to \left|1,\pm \,1\right\rangle \left|r/l\right\rangle .\) one photon production cycle consisting of steps 1–4 takes 200 μs (50 μs) for the cluster (ghz) state sequence. it is repeated n − 2 times, each iteration adding another qubit to a growing chain of entangled photons. for the final photon however (closing), the atomic qubit is transferred from \(\left|1,\pm 1\right\rangle \) to \(\left|2,\mp 1\right\rangle \) (instead of \(\left|2,\pm 2\right\rangle \)) such that, in the subsequent emission process, the atom ends up in \(\left|1,0\right\rangle \), which readily disentangles it from the photonic state. we note that in the case of cluster states, initializing as well as disentangling the atom are not strictly necessary, as the same can be achieved by appropriate z basis measurements of the first and last photons6. in the case of ghz states however, the protocol must be performed as described in fig. 1c to obtain an n-photon state of the form \(\left|{{\rm{ghz}}}_{n}\right\rangle =\left({\left|r\right\rangle }^{\otimes n}+{\left|l\right\rangle }^{\otimes n}\right)/\sqrt{2}\).we start the experiment by producing ghz states. in contrast to cluster states, ghz states are more sensitive to noise and require a higher level of control in their preparation process. regardless, because their density matrix contains only four non-zero entries, it is much easier to measure the fidelity \({{\mathcal{f}}}_{n}\) of an n-photon ghz state35 than for a cluster state, despite the large hilbert space of dimension 2n. therefore, the quantitative analysis of a multiphoton ghz state, besides representing an interesting result by itself, provides a useful tool for benchmarking and gives insights into the inner dynamics of our system.for estimation of the fidelity, it is sufficient to measure the non-zero elements on the diagonal and off-diagonal of the density matrix separately. the diagonal elements represent the populations \({{\mathcal{p}}}_{n}\) of the \({\left|r\right\rangle }^{\otimes n}\) and \({\left|l\right\rangle }^{\otimes n}\) components of the state and can be obtained by measuring all photons in the z basis. the corresponding experimental data, shown in fig. 2b in blue, agree well with the ideal ghz state, for which \({{\mathcal{p}}}_{n}=1\), with only a weak dependence on n. to demonstrate that the states \({\left|r\right\rangle }^{\otimes n}\) and \({\left|l\right\rangle }^{\otimes n}\) are in a coherent superposition, we set the measurement basis to \((\left|r\right\rangle \pm {{\rm{e}}}^{{\rm{i}}\varphi }\left|l\right\rangle )/\sqrt{2}\), in which \(\varphi \in \left[0,{\rm{\pi }}\right]\), thus spanning the full equator of the bloch sphere. this allows us to measure the characteristic parity oscillations, which behave as cos(nϕ) (methods), see fig. 2a. the coherences \({{\mathcal{c}}}_{n}\) of the density matrix are extracted from the visibility of the oscillations for all photon numbers up to n = 10. for 14 photons, the coincidence rate decreases notably owing to the finite photon production efficiency. to acquire enough data, we only measure the parity for ϕ = 0, which is indicated by the yellow diamond in fig. 2b. eventually, the fidelity is calculated using the formula \({{\mathcal{f}}}_{n}=({{\mathcal{p}}}_{n}+{{\mathcal{c}}}_{n})/2\) and is shown in fig. 2b in red. as only a single measurement setting was used for \({{\mathcal{c}}}_{14}\), we also provide a lower bound for the fidelity on the basis of an entanglement witness (methods). with this, we prove genuine 14-photon entanglement with a fidelity \({{\mathcal{f}}}_{14}\ge 76(6) \% \), surpassing the 50% threshold by more than 4 standard deviations. to the best of our knowledge, this is the largest entangled state of photons so far.a, parity measured in the basis \((\left|r\right\rangle \pm {{\rm{e}}}^{{\rm{i}}\varphi }\left|l\right\rangle )/\sqrt{2}\) for photon numbers n = 2, 6 and 10 (see extended data fig. 2 for the full dataset). the coherences \({{\mathcal{c}}}_{n}\) are derived from the visibility of the oscillations. b, populations \({{\mathcal{p}}}_{n}\) (blue squares), coherences \({{\mathcal{c}}}_{n}\) (yellow circles) and extracted fidelities \({{\mathcal{f}}}_{n}\) (red triangles) with weighted linear fits as solid lines. the fidelity is calculated using the formula \({{\mathcal{f}}}_{n}=({{\mathcal{p}}}_{n}+{{\mathcal{c}}}_{n})/2\). for n = 14, the yellow diamond indicates that the coherence was derived from a single measurement setting with ϕ = 0. the dashed grey line marks the classical threshold of 0.5. error bars represent 1 standard deviation.within the measured range, we observe that the decay of \({{\mathcal{p}}}_{n}\), \({{\mathcal{c}}}_{n}\) and \({{\mathcal{f}}}_{n}\) as a function of photon number is well captured by a linear model with a slope of 0.86(9)%, 1.3(2)% and 1.04(9)% per photon, respectively. by extrapolation of this trend, we estimate that the fidelity will cross the 50% threshold at around 44 qubits. the remarkably slow decay in fidelity is particularly astonishing as we observe very little decoherence even when the sequence is deliberately chosen to exceed the intrinsic coherence time of the atomic qubit (about 1 ms). this behaviour is explained by a dynamical decoupling effect built into the protocol, which arises from the opposite signs of the zeeman splitting in the two hyperfine ground-state manifolds. hence, the qubit precession is reversed every time the atom is transferred from \(\left|f=1\right\rangle \) to \(\left|f=2\right\rangle \) or vice versa, which can be seen as two spin-echo pulses for every photon production cycle. although this mechanism contributes to the high-visibility fringes seen in fig. 2a, no extra effort is needed to exploit it (methods). at present, we attribute the main source of infidelity to the vstirap. this can be explained by the finite cooperativity that allows for unwanted paths in the emission process (methods).the characterization of cluster states is more demanding, as the density matrix contains many non-zero elements. we therefore use the entanglement witness \({\mathcal{w}}\) proposed in ref. 36, which is based on the stabilizer formalism. a lower bound of the fidelity can be derived from \({\mathcal{w}}\), requiring only two local measurement settings xzxz... and zxzx... (methods). compared with quantum state tomography, this has the advantage of a tremendous reduction in experimental overhead but comes at the cost of a potentially substantial underestimation of the true state fidelity. nonetheless, the experimental results shown in fig. 3a exceed the 50% threshold for all measured points. here, the data only includes events in which exactly n photons are detected for a sequence of n consecutive generation attempts. for the largest cluster state of 12 photons we find the fidelity to be lower bounded by 56(4)%. comparing the results to the ghz states in fig. 2, we notice a much faster decay of the fidelity (3.6(2)% per photon). besides the large number of raman transfers in the protocol (five transfers per cycle, see methods), we attribute this mainly to the lower bound, which—by construction—underestimates the fidelity. a tighter lower bound that was recently formulated37 could provide a more accurate estimate of the fidelity in future experiments.a, lower bound of the fidelity as provided by ref. 36 obtained from two measurement settings. for the measured data, the lower bound exceeds the threshold of 50% indicated by the grey dashed line. b, measured stabilizers sk given by the expectation value 〈zk−1xkzk+1〉 up to k = 15. all measured stabilizers are larger than 0.9, marked by the dashed line. error bars represent 1 standard deviation.in addition to providing a lower bound for the fidelity, we now present the measured stabilizer operators, defined as sk = zk−1xkzk+1 (fig. 3b). here k ∈ {1, 2, ..., n}, \({z}_{0}={z}_{n+1}={\mathbb{1}}\), and xk and zk denote the respective pauli matrices acting on the kth qubit. in this scenario, events in which three consecutive photons, k − 1, k and k + 1, are detected in the appropriate basis contribute to the stabilizer sk. in principle, arbitrarily many stabilizers could be measured by repeating the protocol for a corresponding number of cycles. here, however, we terminate the sequence at k = 15. we find an average of 〈s1〉 = 96.13(9)% and 〈sk〉 = 92(1)% for k ≥ 2, indicating a large overlap of the generated state with the target linear cluster state.we emphasize that the ability of producing entanglement of up to 14 photons is based, on the one hand, on the excellent coherence properties of the atom and, on the other hand, on the large photon generation and detection efficiencies. the latter is crucial, as the success probability ps of detecting a coincidence of n consecutive photons scales exponentially with the photon number, ps = ηn. here η denotes the probability to generate and detect a single photon for a given attempt. we can express η as the product of the source efficiency η0, that is, the probability of producing a photon at the output of the cavity, and the detection efficiency ηd. it is clear that a low efficiency η ≪ 1 poses a great obstacle to achieving large photonic states within reasonable measurement times.figure 4 shows the raw rate of multiphoton coincidences as a function of photon number n including post-selection and experimental duty cycle. the experimental sequence consists of 14 (12) consecutive photon generation attempts with all timing parameters identical to the ghz (cluster) protocol and a new run starting every 1.1 ms (3.0 ms). the data shown (blue for ghz and red for cluster states) are the coincidence count rates of events in which n consecutive photons were detected starting from the first attempt. for instance, for the largest state of 14 photons, we recorded 151 coincidences in 7 h of experimental runtime, equivalent to roughly one event every 3 min. from an exponential fit to the data, we extract the overall single-photon generation and detection efficiency η = 43.18(7)%. we estimate the intrinsic generation efficiency η0 to be 66%, mainly limited by the cooperativity and the escape efficiency (see ref. 30). both can be optimized by higher-quality mirrors and a smaller cavity-mode volume. the detection efficiency of ηd = 0.7 captures all the remaining loss contributions, such as optical elements and detectors. these include free-space-to-fibre couplings (94% twice), propagation through optical fibre (97%), free-space optics (90%) and detector efficiency (90%). correcting for the detection efficiency ηd, we infer an n-photon coincidence rate at the output of the cavity, as given by the light blue line in fig. 4. this represents the limit of our system with the current parameters. as a comparison, we also show the rate of the best available spdc system, as well as deterministic sources using single quantum dots or rydberg-blockaded atomic ensembles. although the repetition rate for these systems is typically many orders of magnitude higher than in our protocol, our system far outperforms previous implementations in terms of real-time coincidence count rate as well as efficiency scaling.the data (blue for ghz and red for cluster states) represent the number of coincidences divided by the total measurement time. from an exponential fit to the data, we extract a single-photon generation and detection probability of η = 43.18(7)%. the light coloured lines represent the estimated coincidence rate assuming a loss-corrected efficiency of η = 0.66 (see also ref. 30). as a comparison to our atomic cavity quantum electrodynamics (cqed) experiment, we plot equivalent rates for state-of-the-art spdc3, quantum dot (qd) in purple11 and orange12, and rydberg-based13 (ryd) systems. error bars are smaller than the markers.to conclude, we have presented a scalable and freely programmable source of entangled photons, demonstrating—to our knowledge—the largest entangled states of optical photons to this day. it is deterministic in the sense that no probabilistic entangling gates are required. this gives us a clear scaling advantage over previous schemes. moreover, the ability to perform arbitrary single-qubit rotations on the emitter provides the flexibility to grow graph states of different types.at this stage, our system faces mostly technical limitations, such as optical losses, finite cooperativity and imperfect raman pulses. even modest improvements in these respects would put us within reach of loss and fault tolerance thresholds for quantum error correction19,38,39,40. hence, a clear path towards one-way quantum computing architectures would be the generation of two-dimensional cluster states by entangling several photon sources17. for example, in a next step, two of our systems could be coupled through remote quantum logic gates16 to produce 2 × n ‘ladder’ cluster states. alternatively, entangling operations such as gates or bell-state measurements could be performed on two (or more) individual atoms as single emitters in the same cavity14,15. similar strategies apply for the generation of tree graph states and one-way quantum repeaters20,21. the present work thus opens up a new road for photonic quantum computation and communication.the central component of the setup used in this work is a high-finesse optical cavity with a 87rb atom trapped at its centre. the cavity consists of two highly reflective mirrors oriented parallel to each other at a distance of 500 μm with an optical mode waist of w0 = 30 μm. the two mirrors have a transmitivity of t1 = 100 ppm and t2 = 4 ppm, giving rise to a finesse of f ≈ 60,000, such that photons populating the cavity mode are outcoupled predominantly through the low-reflective side. the cavity is tuned to the atomic d2 line with a detuning of δc = −150 mhz with respect to the transition \(\left|f=1\right\rangle \leftrightarrow \left|{f}^{{\prime} }=1\right\rangle \). the combined system of the atom and cavity is best described in the framework of cavity quantum electrodynamics with parameters (g, κ, γ) = 2π × (cge × 10.8, 2.7, 3.0) mhz, g being the atom–cavity coupling strength for the relevant transition, κ the decay rate of the cavity field and γ the free-space atomic decay rate associated with the d2 transition of 87rb. cge is the clebsch–gordan coefficient between the relevant excited state (\(\left|e\right\rangle \)) coupling to the vstirap control pulse and the final state (\(\left|g\right\rangle \)) of the photon production process. the above parameters put our system in the intermediate to strong coupling regime with a cooperativity parameter defined as c = g2/(2κγ). note that the specific value of c depends on the transition path associated to a certain excited state. for example, for the emission from \(\left|2,\pm 2\right\rangle \) as in the cycling step of the protocol, we have \(\left|g\right\rangle =\left|f=1,{m}_{f}=\pm 1\right\rangle \) and \(\left|e\right\rangle =\left|{f}^{{\prime} }=2,{m}_{f}^{{\prime} }=\pm 2\right\rangle \). hence, we get \({c}_{{\rm{ge}}}=\sqrt{1/4}\), giving c = 1.8.atoms are transferred from a magneto-optical trap to the centre of the cavity, in which they are trapped by a two-dimensional optical lattice composed of two standing-wave potentials, one at 772 nm oriented along the cavity axis and one at 1,064 nm propagating perpendicular to the cavity axis. an electron-multiplying charge coupled device camera detects the atomic fluorescence, which is collected by means of a high-numerical-aperture objective. a single atom is prepared quasi-deterministically by removing any excess atom with a resonant laser beam steered onto the atom by means of an acousto-optic deflector. the position of the atom is monitored during the experiment and controlled through appropriate feedback to the optical trapping potential.because the atoms have a finite lifetime in the dipole trap, they have to be reloaded regularly. the average trapping time depends markedly on the type of conducted experiment (that is, heating/cooling mechanisms). for our experiments, we achieved an average trapping time of roughly 20 s. the time required for loading and repositioning of the atom after occasional jumps to a different location reduces the experimental duty cycle. by counting the number of experimental runs carried out at a given repetition rate over a longer measurement interval, we evaluate the overall duty cycle to be close to 50%.once a camera image shows that the atom has moved away from the target position, the corresponding data to that image are discarded through post-selection processing. the same applies to images with more than one atom near the cavity centre.further post-selection is performed by processing the data collected by the single-photon detectors: an experimental run is considered successful when n photons were detected in a row, each within predefined time windows (1 μs width in this work). note that fig. 4 shows the coincidence rate after applying post-selection.the full experimental sequence including timings of the optical pulses is shown in extended data fig. 1. as described in the main text, it mainly consists of a repeating sequence of single-qubit rotations and photon emissions (cycling), with further initialization and closing steps at the beginning and the end. the atom is initialized in the state \(\left|2,0\right\rangle \) by optical pumping (5 μs). a square-shaped control pulse (1.5 μs) produces the first photon, thus generating the atom–photon entangled state \(\left|1,1\right\rangle \left|{r}_{1}\right\rangle -\left|1,-\,1\right\rangle \left|{l}_{1}\right\rangle \) (up to normalization), in which the index ‘1’ refers to the first photon. if no photon was detected, we immediately go back to the state preparation step and another photon attempt. we choose a maximum of seven attempts for the first photon to avoid excessive heating of the atom. after a successful first photon detection, we start the cycling stage with the single-qubit gate, which—for cluster states—consists of a π/2 rotation contained in three raman manipulations. first, the population in \(\left|1,1\right\rangle \) is transferred to \(\left|2,0\right\rangle \) with a π pulse, taking 53 μs. then a π/2 pulse is applied to the transition \(\left|1,-\,1\right\rangle \leftrightarrow \left|2,0\right\rangle \), realizing the qubit rotation. afterwards, the population in \(\left|2,0\right\rangle \) is transferred back to \(\left|1,1\right\rangle \) with another π pulse. the operation described transforms the basis states as follows: \(\left|1,1\right\rangle \to \left|1,1\right\rangle +\left|1,-\,1\right\rangle \) and \(\left|1,-\,1\right\rangle \to -\left|1,1\right\rangle +\left|1,-\,1\right\rangle \). the whole pulse sequence for the single-qubit gate takes 132.5 μs. for ghz states, the required rotation angle is θ = 0, which means that the qubit rotation can be skipped entirely. to produce the next photon, we transfer the population from \(\left|1,\pm \,1\right\rangle \) to \(\left|2,\pm \,2\right\rangle \) by means of two sequential raman π pulses (790 nm), each taking 21 μs. we then apply a vstirap control pulse, leading to a photon emission. the atom–photon–photon state then reads \(\left(\left|1,1\right\rangle \left|{r}_{2}\right\rangle +\left|1,-\,1\right\rangle \left|{l}_{2}\right\rangle \right)\left|{r}_{1}\right\rangle -\left(-\left|1,+\,1\right\rangle \left|{r}_{2}\right\rangle +\left|1,-\,1\right\rangle \left|{l}_{2}\right\rangle \right)\left|{l}_{1}\right\rangle \) for cluster states, that is, θ = π/2. the index ‘2’ now refers to the second photon. the cycling step is repeated as many times as desired. in the very last cycle, the closing step is performed. here, following the qubit rotation, the atomic population is transferred from \(\left|1,\pm \,1\right\rangle \) to \(\left|2,\mp \,1\right\rangle \) instead of \(\left|2,\pm \,2\right\rangle \), which takes 55 μs. thus the atom is disentangled in the subsequent photon emission. this step can be seen as an atom-to-photon state transfer, as the atomic qubit is mapped to the polarization state. after the last photon, we run a calibration sequence for actively stabilizing the optical power of the laser pulses. finally, the atom is laser-cooled for several hundred microseconds. the length of a full period of the experiment including calibration and cooling depends on the type of state produced and the number of photons n. it can be as short as 400 μs and as long as 3 ms.the raman transitions shown as orange and green arrows in extended data fig. 1 are performed with a 790-nm laser. the duration of these transitions make up the most part of the experimental sequence. in principle, choosing a higher rabi frequency could drastically increase the repetition rate of the protocol but would lead to more crosstalk between the transitions, as they would start to overlap in frequency space. as a consequence, a compromise between repetition rate and high-fidelity raman manipulations has to be found. for our choice of experimental parameters, we estimate the infidelity per single-qubit rotation to be smaller than 1%.the raman transfer in the closing step from \(\left|f=1\right\rangle \) to \(\left|f=2\right\rangle \) is realized with a 795-nm raman laser close to the d1 line of rubidium. for this specific raman transition, we cannot choose a large detuning because this would lead to a destructive interference owing to the clebsch–gordan coefficients. as a consequence, we have a chance of about 5% of spontaneous scattering, which reduces the fidelity. as mentioned in the main text, alternatively, the atom can also be disentangled from the photonic state by measuring the most recently generated photon in the z basis. although this would slightly increase the fidelity, the rate would decrease, as the detection of an extra photon is required.for ghz states, we observe a total error rate of about 1% per photon. we attribute most of the infidelity to spontaneous scattering during the photon production process, as the vstirap control pulse couples to the f′ = 3 excited state of the d2 line. this opens a decay channel, which competes with the coherent emission of the photon. by post-selecting on early photon arrival, one can partly filter out events in which scattering has occurred (extended data fig. 4). in the future, this could be eliminated by generating the photons on the d1 line, in which no f′ = 3 state is present. this should greatly improve the error rate.the same error mechanism applies in the case of cluster states. furthermore, the single-qubit gate implemented with raman lasers introduces errors, which we estimate to be smaller than 1%. these could be explained by finite frequency resolution, pulse intensity fluctuations, as well as drifts in optical alignment. for instance, increasing the zeeman splitting would be a way to further optimize this process.minor sources of error include polarization alignment. for setting the polarization detection basis, we use a reference polarizer in front of the cavity and measure the polarization extinction to be on the order of 10,000:1. for switching the detection basis, we use a polarization electro-optic modulator (qubig pc3r-nir) with a switching time of 5 ns. the extinction ratio is specified as >1,000:1, whereas we measured values of around 5,000:1.the error rate for cluster states of 3.6% as given in the main text is presumably overestimated owing to the definition of the fidelity lower bound. taking into account the error sources identified above, we estimate the true error rate to be smaller than 2%. with the suggested improvements, we expect a reduction well below 1% to be realistic.the intrinsic source efficiency, that is, the probability of obtaining a photon at the output of the cavity, is given byin which c ≈ 1.5 is the cooperativity and ηesc ≈ 0.88 denotes the escape efficiency, that is, the probability of a photon being outcoupled from the output port30. note that the above formula is only valid in the case of a single excited state, whereas the efficiency becomes a function of the detuning, η0 (δ), when several excited states are present.the source efficiency could hence be improved by increasing both the cooperativity and the escape efficiency. as the two parameters are generally not independent, let us assume for simplicity that we reduce the waist of the cavity mode by a factor of 2. this increases the cooperativity by a factor of 4 without altering the escape efficiency. we would thereby improve the source efficiency from 66% to 81%.furthermore, the efficiency of the detection setup could be improved. for instance, by redesigning and optimization of the setup, one could replace a fibre-to-fibre coupling with a fibre splice, eliminate a free-space-to-fibre coupling and reduce the losses from optical surfaces. in this scenario, an improvement of the detection efficiency ηd from 0.7 to 0.85 seems feasible. given these realistic improvements, the combined source-to-detection efficiency η would reach the mark of 2/3, an important threshold for linear optical quantum computation40.in the mathematical formalism of spin 1/2 particles, a ghz state looks likein which in the photonic case \(\left|\uparrow \right\rangle /\left|\downarrow \right\rangle \) corresponds to \(\left|r\right\rangle /\left|l\right\rangle \). for measuring the diagonal elements of the density matrix, that is, the populations \({{\mathcal{p}}}_{n}\) of the \({\left|\uparrow \right\rangle }^{\otimes n}\) and \({\left|\downarrow \right\rangle }^{\otimes n}\) components, it suffices to measure all particles in the z basis to obtainfor the coherences, we introduce the parity operator3,35describing a measurement of all n particles in the basis \(\left(\left|\uparrow \right\rangle \pm {{\rm{e}}}^{{\rm{i}}\varphi }\left|\downarrow \right\rangle \right)/\sqrt{2}\). varying the parameter ϕ from 0 to π corresponds to a continuous rotation of the measurement basis along the equator of the bloch sphere. in the experiment, this is achieved by scanning the angle of a half-wave plate in front of the pbs in the detection setup. it is straightforward to show that the expectation value of \({{\mathcal{m}}}_{\varphi }\) for the ideal ghz state isthese characteristic parity oscillations are what can be seen in fig. 2a. the amplitudes of the oscillations as obtained from a cosine fit are a measure for the coherences of the density matrix. the fidelity is then obtained from the formulafor the largest photon number of n = 14, we chose to measure an entanglement witness derived in ref. 36 to obtain a fidelity lower bound. the witness is based on the stabilizer formalism, the stabilizing operators for ghz states beingin which k = 1, 2, ..., n and zk and xk are the pauli matrices acting on the kth qubit. with this, the fidelity is lower bounded bya lower bound for the fidelity can be derived in a similar fashion for one-dimensional cluster states36. with the set of stabilizers sk as defined in the main text, the bound is given by the inequalityit is easy to verify by direct calculation that the terms for even and odd k in equation (10) correspond to the local measurement settings zxzx... and xzxz..., respectively. as an example, for a four-qubit linear cluster state, we havein the main text, we already highlighted that our system benefits from a built-in dynamical decoupling mechanism owing to the level structure of the atomic hyperfine ground states. a measurement of the intrinsic coherence time of the atom can be seen in extended data fig. 3a. here we look at the overlap between two photons both emitted from the atom with a variable time delay. the first photon is measured in the linear basis (\(\left|h\right\rangle /\left|v\right\rangle \)), which projects the atom onto a superposition of the qubit states \(\left|1,+1\right\rangle \) and \(\left|1,-1\right\rangle \). the atomic state then precesses with twice the larmor frequency. after a certain time t, the atomic qubit is read out by mapping it onto a photon, which is then measured in the same basis as the first photon. the fidelity, which we define as the projection of the second photon on the first, shows oscillations damped by noise, such as magnetic field fluctuations. after roughly 1.2 ms, the envelope of the oscillations crosses the classical threshold of 0.66, which defines the intrinsic coherence time of the atomic qubit. for the ghz sequence however, we observe that the effect of decoherence is intrinsically reduced. we can show this by artificially extending the length of the sequence to 1.25 ms for a six-photon ghz state. in this case, every photon production cycle takes 300 μs. the ratio of time that the qubit resides in \(\left|f=1\right\rangle \) and \(\left|f=2\right\rangle \) can then be varied by scanning the delay τ between the hyperfine transfer from \(\left|1,\pm \,1\right\rangle \) to \(\left|2,\pm \,2\right\rangle \) and the vstirap control pulse, as illustrated in extended data fig. 3b. for different values of τ, we record the parity oscillations similar to fig. 2a and infer the visibility. from the measured data, we can see a clear dependence of the visibility as a function of τ, with a rephasing appearing at around 85 μs. the maximum value is roughly equal to the six-photon coherence shown in fig. 2 (shown as a dashed line for reference), for which the sequence length was only 250 μs. this is strong evidence that a large part of the decoherence is mitigated as an inherent feature of the protocol.the datasets generated and/or analysed during the current study are available at https://doi.org/10.5281/zenodo.6598546. further information is available from the corresponding author on reasonable request.bennett, c. h. & divincenzo, d. p. quantum information and computation. nature 404, 247–255 (2000).cas article ads google scholar preskill, j. quantum computing in the nisq era and beyond. quantum 2, 79 (2018).article google scholar zhong, h.-s. et al. 12-photon entanglement and scalable scattershot boson sampling with optimal entangled-photon pairs from parametric down-conversion. phys. rev. lett. 121, 250505 (2018).article ads google scholar schön, c. et al. sequential generation of entangled multiqubit states. phys. rev. lett. 95, 110503 (2005).article ads google scholar wilk, t., quantum interface between an atom and a photon. dissertation, technische universität münchen. http://mediatum.ub.tum.de/node?id=637078 (2008).lindner, n. h. & rudolph, t. proposal for pulsed on-demand sources of photonic cluster state strings. phys. rev. lett. 103, 113602 (2009).article ads google scholar reiserer, a. & rempe, g. cavity-based quantum networks with single atoms and optical photons. rev. mod. phys. 87, 1379 (2015).cas article ads google scholar greenberger, d. m., horne, m. a. & zeilinger, a. in bell’s theorem, quantum theory and conceptions of the universe (ed. kafatos, m.) 69–72 (springer, 1989).hein, m. et al. in quantum computers, algorithms and chaos https://ebooks.iospress.nl/publication/27431 115–218 (ios press, 2006).yao, x.-c. et al. experimental demonstration of topological error correction. nature 482, 489–494 (2012).cas article ads google scholar schwartz, i. et al. deterministic generation of a cluster state of entangled photons. science 354, 434–437 (2016).cas article ads google scholar istrati, d. et al. sequential generation of linear cluster states from a single photon emitter. nat commun 11, 5501 (2020).cas article ads google scholar yang, c.-w. et al. sequential generation of multiphoton entanglement with a rydberg superatom. preprint at https://arxiv.org/abs/2112.09447 (2021).welte, s. et al. photon-mediated quantum gate between two neutral atoms in an optical cavity. phys. rev. x 8, 011018 (2018).cas google scholar langenfeld, s., thomas, p., morin, o. & rempe, g. quantum repeater node demonstrating unconditionally secure key distribution. phys. rev. lett. 126, 230506 (2021).cas article ads google scholar daiss, s. et al. a quantum-logic gate between distant quantum-network modules. science 371, 614–617 (2021).cas article ads google scholar russo, a., barnes, e. & economou, s. generation of arbitrary all-photonic graph states from quantum emitters. new j. phys. 21, 055002 (2019).cas article ads google scholar raussendorf, r. & briegel, h. j. a one-way quantum computer. phys. rev. lett. 86, 5188 (2001).cas article ads google scholar briegel, h. j., browne, d. e., dür, w., raussendorf, r. & van den nest, m. measurement-based quantum computation. nat. phys 5, 19–26 (2009).cas article google scholar zwerger, m., dür, w. & briegel, h. j. measurement-based quantum repeaters. phys. rev. a 85, 062326 (2012).article ads google scholar borregaard, j. et al. one-way quantum repeater based on near-deterministic photon-emitter interfaces. phys. rev. x 10, 021071 (2020).cas google scholar sackett, c. a. et al. experimental entanglement of four particles. nature 404, 256–259 (2000).cas article ads google scholar omran, a. et al. generation and manipulation of schrödinger cat states in rydberg atom arrays. science 365, 570–574 (2019).mathscinet cas article ads google scholar gong, m. et al. genuine 12-qubit entanglement on a superconducting quantum processor. phys. rev. lett. 122, 110501 (2019).cas article ads google scholar besse, j.-c. et al. realizing a deterministic source of multipartite-entangled photonic qubits. nat. commun. 11, 4877 (2020).cas article ads google scholar pogorelov, i. et al. compact ion-trap quantum computing demonstrator. prx quantum 2, 020343 (2021).article ads google scholar walther, p. et al. experimental one-way quantum computing. nature 434, 169–176 (2005).cas article ads google scholar lanyon, b. p. et al. measurement-based quantum computation with trapped ions. phys. rev. lett. 111, 210501 (2013).cas article ads google scholar stolz, t. et al. a quantum-logic gate between two optical photons with an efficiency above 40%. phys. rev. x 12, 021035 (2022).cas google scholar morin, o., körber, m., langenfeld, s. & rempe, g. deterministic shaping and reshaping of single-photon temporal wave functions. phys. rev. lett. 123, 133602 (2019).mathscinet cas article ads google scholar schupp, j. et al. interface between trapped-ion qubits and traveling photons with close-to-optimal efficiency. prx quantum 2, 020331 (2021).article ads google scholar tomm, n. et al. a bright and fast source of coherent single photons. nat. nanotechnol. 16, 399–403 (2021).cas article ads google scholar knall, e. et al. efficient source of shaped single photons based on an integrated diamond nanophotonic system. preprint at https://doi.org/10.48550/arxiv.2201.02731 (2022).senellart, p., solomon, g. & white, a. high-performance semiconductor quantum-dot single-photon sources. nat. nanotechnol. 12, 1026–1039 (2017).cas article ads google scholar gühne, o., lu, c.-y., gao, w.-b. & pan, j.-w. toolbox for entanglement detection and fidelity estimation. phys. rev. a 76, 030305 (2007).article ads google scholar tóth, g. & gühne, o. detecting genuine multipartite entanglement with two local measurements. phys. rev. lett. 94, 060501 (2005).article ads google scholar tiurev, k. & sørensen, a. s., fidelity measurement of a multiqubit cluster state with minimal effort. preprint at https://arxiv.org/abs/2107.10386 (2021).barrett, s. d. & stace, t. m. fault tolerant quantum computation with very high threshold for loss errors. phys. rev. lett. 105, 200502 (2010).article ads google scholar raussendorf, r. & harrington, j. fault-tolerant quantum computation with high threshold in two dimensions. phys. rev. lett. 98, 190504 (2007).article ads google scholar varnava, m., browne, d. e. & rudolph, t. how good must single photon sources and detectors be for efficient linear optical quantum computation? phys. rev. lett. 100, 060502 (2008).article ads google scholar download referencesthe authors thank a. sørensen for valuable discussions. this work was supported by the bundesministerium für bildung und forschung through the verbund qr.x (16kisq019), by the deutsche forschungsgemeinschaft under germany’s excellence strategy - exc-2111 - 390814868 and by the european union’s horizon 2020 research and innovation programme through the project quantum internet alliance (qia, grant agreement no. 820445).open access funding provided by max planck society.max-planck-institut für quantenoptik, garching, germanyphilip thomas, leonardo ruscio, olivier morin & gerhard rempeyou can also search for this author in pubmed google scholaryou can also search for this author in pubmed google scholaryou can also search for this author in pubmed google scholaryou can also search for this author in pubmed google scholarall authors contributed to the experiment, analysis of the results and writing of the manuscript.correspondence to philip thomas.the authors declare no competing interests.nature thanks ofer firstenberg, peter lodahl and valentina parigi for their contribution to the peer review of this work. peer reviewer reports are available.publisher’s note springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.as in fig. 1c, the sequence is divided into initialization, cycling and closing. after each run, we perform several hundreds of microseconds of active power stabilization of laser pulses, as well as atom cooling. the sequence shown takes up to 3 ms, depending on the number of photons and the type of photonic state (ghz or cluster).complete dataset for the ghz coherence measurements for all measured photon numbers n.a, intrinsic memory coherence measured as the overlap between two photons emitted from the atom with a variable delay. the inset shows a zoom of the oscillations owing to the time evolution of the atomic qubit states. the arrow shows the sequence length for the data taken in b. b, visibility of parity oscillations for a six-photon ghz state as a function of temporal delay τ between the hyperfine remapping and the vstirap control pulse. as a model is difficult to obtain for an unknown noise spectrum, a gaussian fit to the data (solid line) provides a guide to the eye. a maximum of the visibility can be observed for around 85 μs.two photons are generated in subsequent cycles of the ghz protocol and measured in the r/l basis. their correlation (red) is analysed as a function of maximum permitted arrival time tmax with respect to the beginning of the emission process. the relative efficiency (blue) shows the number of counts detected up to tmax, as opposed to the full photonic wave packet. the correlation decreases as a function of tmax, which we attribute to spontaneous scattering events induced by the vstirap control pulse. the dashed line marks the value of tmax used in this work.open access this article is licensed under a creative commons attribution 4.0 international license, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the creative commons license, and indicate if changes were made. the images or other third party material in this article are included in the article’s creative commons license, unless indicated otherwise in a credit line to the material. if material is not included in the article’s creative commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. to view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.reprints and permissionsthomas, p., ruscio, l., morin, o. et al. efficient generation of entangled multiphoton graph states from a single atom. nature 608, 677–681 (2022). https://doi.org/10.1038/s41586-022-04987-5download citationreceived: 26 january 2022accepted: 16 june 2022published: 24 august 2022issue date: 25 august 2022doi: https://doi.org/10.1038/s41586-022-04987-5anyone you share the following link with will be able to read this content:sorry, a shareable link is not currently available for this article. provided by the springer nature sharedit content-sharing initiative by submitting a comment you agree to abide by our terms and community guidelines. if you find something abusive or that does not comply with our terms or guidelines please flag it as inappropriate.