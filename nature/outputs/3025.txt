new computational method uses convolutional neural networks for cis-regulatory sequence analysis to analyze and cluster scatac-seq data.you have full access to this article via your institution.convolutional neural networks (cnns) provide a powerful lens through which to decipher the genomic regulatory code. cnns have been successfully trained on regulatory dna sequences to predict transcription factor (tf) binding1, chromatin accessibility2,3,4, enhancer activity5 and gene expression6. to train such networks, convolutional filters in the first layer are applied across the input sequence, resulting in the activation of sequence motifs relevant for the final predictions. the size of the filters is usually chosen to reflect the width of a tf motif, so that many of the learned features represent tf motifs. next, additional convolutional, recurrent or transformer layers provide a means to learn how tf motifs are combined and organized. these layers are followed by dense layers that exploit the learned representation for classification or regression. after training, the cnn is mostly used to discover important cis-regulatory features, including the presence or absence of, respectively, activator and repressor motifs; but also more advanced architecture of enhancers and promoters including motif combinations, orientation of motifs, distance between motifs, and the presence of nucleosome binding preferences. compared to conventional techniques for sequence analysis with position weight matrices or de novo motif discovery, cnns that are combined with network explainability methods7 provide a promising route to overcoming the high false-positive rate in tf binding site predictions (called the ‘futility theorem’8). sequence-based cnns are particularly promising for learning regulatory codes across many cell types — for example, by applying them to atlases of single-cell chromatin accessibility data2,3. indeed, single-cell atac-seq (scatac-seq) provides chromatin accessibility profiles for every cell type in a heterogeneous tissue, or for every cell state in a dynamic biological process9,10. cnns can then be trained on all cell type-specific accessible regions at once. however, when using scatac-seq data, this approach depends on a high-quality clustering of cells by cell type or cell state, which can be a challenge given the high noise and sparsity in these data9. yuan and kelley address this problem in this issue by exploiting sequence-based cnns to learn a high-confidence single-cell representation11. before describing this method, i will briefly summarize conventional approaches for learning a single-cell representation from scatac-seq data.the analysis of scatac-seq data is challenging owing to its high drop-out rates (for each single cell, only about 10% of the accessible regions can be captured). to address this challenge, computational techniques have been applied, often borrowing from other fields that deal with sparse data, such as text mining. this analysis aims to provide a lower-dimensional representation of the data, keeping only the relevant information for better visualization and clustering. examples of such techniques are latent semantic indexing (lsi)3,12 and latent dirichlet allocation (lda)13. alternatively, variational autoencoders (vae) have proven to successfully handle this task: an encoder uses the (binary) scatac-seq vector of a cell as input (each cell is a sample) and passes it through a lower-dimensional bottleneck layer, followed by a decoder that predicts the original scatac-seq vector14. these methods, either linear or nonlinear, all derive latent variables (lvs) that allow the grouping of cells by factor, topic or neuron. after this unsupervised learning step, cells can be clustered in the lower-dimensional space. these clusters can be used to identify differentially accessible regions per cluster, which can then be used as training data for cnn-based learning as explained above.in this issue, yuan and kelley present a deep learning method called scbasset that aims to solve the scatac-seq cell clustering problem by jointly learning the sequence information using cnns. rather than relying only on the sparse scatac-seq data, the neural network uses the dna sequence (1,344 bp, encompassing the atac-seq peak) as input and predicts the vector of accessibility of that region across all cells. when applied to all peaks, the cnn learns to regenerate the scatac-seq peak-by-cell (binary) accessibility matrix, purely on the basis of the peak sequences. as network topology, yuan and kelly modified the basset topology using a series of eight convolution blocks, each using a different number of filters (fig. 1). after that, the flattened vector of convoluted data is connected to a dense layer of bottleneck size 32, similar to those used in autoencoders. next, this low-dimensional vector representation of each encoded sequence is fully connected to the one-dimensional vector of binary accessibility in each cell. the weights of this final layer form a [32 × number of cells] matrix representing the cell embedding, and this matrix is used for cell clustering and further analysis. the authors show via extensive benchmarking on three datasets that scbasset is at least on par with, and often outperforms, existing methods in terms of cell clustering. they were able to cleverly assess this by training their models on the scatac-seq part of multi-omics datasets while using the scrna-seq part to define ‘true’ cell clusters. this result convincingly shows that learned sequence features in the encoding step are informative for cell embedding.scbasset combines sequence-based learning using convolutional neural networks (cnns) with representation learning of single-cell atac-seq data by encoding sequences in a low-dimensional (32-latent-variable (lv)) representation that is subsequently decoded into a scatac-seq vector over all the single cells. the [32 lv × number of cells] weight matrix of the final layer is thereby used for cell embedding. scbasset can be used for cell clustering, batch effect correction and scatac-seq denoising, as well as to ‘explain’ enhancer sequence and tf binding site predictions, similarly to the sequence-based cnns in the upper panel.furthermore, yuan and kelly modify their cnn topology by adding an extra layer, in parallel with the final dense layer, to take batch effects into account, creating scbassset-bc. the decoding step to scatac-seq now balances the sequence input and the batch effect. this modification results in batch effect correction on the peripheral blood mononuclear cell test case, which has well-defined batches. in addition, the scbasset learning process infers a denoised accessibility matrix, and the authors show that the signal-to-noise ratio after scbasset-bc denoising is higher than those produced by existing denoising methods, and that it leads to improved integration with scrna-seq data.the exploitation of sequence features to drive scatac-seq data analysis has been used before, particularly by the method chromvar15. chromvar a priori aggregates the scatac-seq reads over sets of sequences that share a tf motif instance, and thereby reduces the dimensionality of the scatac-seq matrix to [number of motifs × number of cells], after which cells are clustered. with scbasset, these motifs are learned by the cnn and jointly optimized with the scatac-seq-based cell representation. in addition, when scrna-seq data is available, these motifs can be correlated with tf activity and expression. the final application of the scbasset model is to derive and visualize these sequence features, particularly to highlight important nucleotides and candidate tf-binding sites. the authors achieve this by scoring mutated sequences, in a technique referred to as ‘in silico mutagenesis’. this strategy circumvents the caveat that the derivation of nucleotide contribution scores with deeplift7 is too computationally intensive for the scbasset topology. although yuan and kelly do not compare the accuracy of scbasset sequence explanations with a conventional cnn (fig. 1, top layer) that is trained a posteriori on clustered cells or topics, their results show that scbasset with in silico mutagenesis reveals key tf binding sites underlying cell type-specific chromatin accessibility.with its computational efficiency and integrated analysis of cells and dna regulatory sequences, scbasset is a highly original tool with the potential to become a key component for the analysis of single-cell regulatory genomics data and for the interpretation of the genomic regulatory code. scbasset can process large scatac-seq (or multi-ome) atlases to simultaneously identify stable cell states and obtain insight into key transcription factors that regulate that state. hence, it can also be applied to disease-related datasets, where it may reveal regulatory changes that underlie disease states. finally, scbasset can serve as an inspirational starting point to build more complex deep-learning models in the future that take the sequence of larger genomic loci as input to predict gene expression, and thus learn and explain single-cell representations of the transcriptome through the genomic regulatory code.avsec, ž. et al. nat. genet. 53, 354–366 (2021).cas article google scholar janssens, j. et al. nature 601, 630–636 (2022).cas article google scholar cusanovich, d. a. et al. cell 174, 1309–1324.e18 (2018).cas article google scholar kelley, d. r., snoek, j. & rinn, j. l. genome res. 26, 990–999 (2016).cas article google scholar de almeida, b. p., reiter, f., pagani, m. & stark, a. nat. genet. 54, 613–624 (2022).article google scholar avsec, ž. et al. nat. methods 18, 1196–1203 (2021).cas article google scholar shrikumar, a., greenside, p. & kundaje, a. preprint at https://doi.org/10.48550/arxiv.1704.02685 (2019).wasserman, w. w. & sandelin, a. nat. rev. genet. 5, 276–287 (2004).cas article google scholar minnoye, l. et al. nat. rev. methods primer 1, 10 (2021).cas article google scholar lareau, c. a. et al. nat. biotechnol. 37, 916–924 (2019).cas article google scholar yuan, h. & kelly, d. r. nat. methods https://doi.org/10.1038/s41592-022-01562-8 (2022).stuart, t., srivastava, a., madad, s., lareau, c. a. & satija, r. nat. methods 18, 1333–1341 (2021).cas article google scholar bravo gonzález-blas, c. et al. nat. methods 16, 397–400 (2019).article google scholar xiong, l. et al. nat. commun. 10, 4576 (2019).article google scholar schep, a. n., wu, b., buenrostro, j. d. & greenleaf, w. j. nat. methods 14, 975–978 (2017).cas article google scholar download referencesi am grateful to niklas kempynck, nikolai hecker, gabriele partel, ibrahim ihsan taskiran, carmen bravo gonzález-blas, harold o. f. snyers d'attenhoven, and ioannis sarropoulous for critical comments and advice on the text and to duygu koldere vilain for her help with the figure design.vib center for brain & disease research, leuven, belgiumstein aertsdepartment of human genetics, ku leuven, leuven, belgiumstein aertsyou can also search for this author in pubmed google scholarcorrespondence to stein aerts.the author declares no competing interests.reprints and permissionsaerts, s. how regulatory sequences learn cell representations. nat methods (2022). https://doi.org/10.1038/s41592-022-01570-8download citationpublished: 08 august 2022doi: https://doi.org/10.1038/s41592-022-01570-8anyone you share the following link with will be able to read this content:sorry, a shareable link is not currently available for this article. provided by the springer nature sharedit content-sharing initiative 