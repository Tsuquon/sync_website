with the tip of her syringe, brandi pokes at a grey lump of heroin in a spoon. it’s a new variety of the drug that has shown up on the market in the past few days, and brandi likes it. i feel this more, i feel more of the pain resistance, she says.once it has dissolved into a liquid, she injects it into her arm, then uses a fresh needle to inject the skinny arm of another woman. she does it better than the hospital, the woman comments.i’ll help anybody who needs it, brandi explains to public-health researcher daniel ciccarone of the university of california, san francisco, who has been filming the entire process.ciccarone’s team has embedded with brandi — whose name has been changed for this story — in charleston, west virginia, documenting her interactions without judgement or interference. later, the group will analyse this video, in addition to half a dozen other videos of drug users from across the city, logging details big and small. brandi does not heat the solution on the spoon, for instance, and that may increase the likelihood of spreading viruses such as hiv. and tests reveal that what she’s taking has been laced with fentanyl, a synthetic drug up to 50 times more powerful than heroin.the researchers will plug these data into powerful computer simulations of charleston, populated by thousands of virtual brandis — heroin users and dealers going about their daily routines. they will watch these digital agents buy more heroin as their tolerance increases, form networks with sellers and users and, in some cases, accidentally overdose.ciccarone’s is one of several groups using agent-based models to understand what is driving the us opioid epidemic — the dramatic rise over the past two decades in the use of opioids, including prescription pain medications and illegal drugs such as heroin. by studying the motivations and practices of real drug dealers and users, the researchers hope to build agents whose behaviour in the virtual world mimics that in real life. agent-based models promise to provide a more granular view of the opioid crisis than standard modelling, which is based on average populations, and to capture some of the complexity of the driving forces. this could prove important for demonstrating the effects of opening or closing methadone clinics or needle exchanges. the models allow scientists to compare interventions at almost no cost and could help policymakers to decide how to proceed in the real world. it’s a very classic and useful way to try and see where is the best place to deploy an intervention to have the biggest effect, says john brooks, a medical adviser for the division of hiv/aids prevention at the us centers for disease control and prevention (cdc) in atlanta, georgia.although such simulations have long been used to model disease outbreaks and have, in some instances, guided public policy, their track record with more complex social behaviour such as drug use is limited, largely owing to sparse data and the breadth of parameters to consider.still, scientists hope that agent-based models can lay out scenarios for decision-makers, who are often driven more by politics than data. the barriers are not scientific or medical, ciccarone says. you can throw $1 billion at west virginia, and they may or may not know how to use it well. these virtual worlds can add clarity, says joshua epstein, director of the agent-based modeling lab at new york university. you can literally watch the thing unfold before your eyes, he says.the us opioid crisis is estimated to kill 115 people per day through overdoses, and has run up us$1 trillion in health-care costs and lost productivity since 2001. it is not the first addiction crisis that the united states has faced, nor is it the most severe. alcohol use causes many more deaths, and the rate of cocaine overdose among african americans is similar to the rate of opioid overdose in white americans1.but the opioid crisis does have some different driving factors, including the prevalence of prescription drugs, which many have used on the way to abusing illegal drugs, and the introduction of fentanyl, which is often used to boost the potency of heroin and is responsible for a large share of overdose deaths. the epidemic has also hit hard in rural settings, where services and infrastructure for dealing with addiction are scarce. the demographic now encompasses a population that in the past has not been so affected, says nora volkow, director of the us national institute on drug abuse in bethesda, maryland.as a result, researchers are coming up with fresh ways of thinking about the crisis. it bears similarities to a disease epidemic, for example, in the way it spreads through networks based on personal relationships and physical proximity, says georgiy bobashev, a data scientist at the non-profit research institute rti international in research triangle park, north carolina. nobody is born an addict. somebody has to teach you how to smoke or how to inject.youngstown in ohio has high rates of unemployment and opioid addiction.credit: spencer platt/gettythese personal networks can be replicated using agent-based modelling. unlike other types of model, which may rely on average characteristics or relationships between homogeneous groups to inform algorithms, agent-based models allow researchers to see subtle connections between people. that’s useful because drug use and overdose is inherently personal, says epidemiologist brandon marshall of brown university in providence, rhode island. factors such as job loss, mental health or genetics can influence how likely a person is to begin using drugs or become addicted, but those factors might fade into the averages if researchers looked at a population as a whole.to create an agent-based model, researchers first ‘build’ a virtual town or region, sometimes based on a real place, including buildings such as schools and food shops. they then populate it with agents, using census data to give each one its own characteristics, such as age, race and income, and to distribute the agents throughout the virtual town.the agents are autonomous but operate within pre-programmed routines — going to work five times a week, for instance. some behaviours may be more random, such as a 5% chance per day of skipping work, or a 50% chance of meeting a certain person in the agent’s network. once the system is as realistic as possible, the researchers introduce a variable such as a flu virus, with a rate and pattern of spread based on its real-life characteristics. they then run the simulation to test how the agents’ behaviour shifts when a school is closed or a vaccination campaign is started, repeating it thousands of times to determine the likelihood of different outcomes.in 2015, data from an agent-based model2 developed at the university of pittsburgh in pennsylvania helped california state senator richard pan to gain support for a bill on mandatory vaccination in his state. pan used the simulation to demonstrate to his fellow senators how measles outbreaks could unfold in their home districts. it certainly made an impact on them, pan says. instead of just describing it in more abstract terms, [the model] can make it more concrete. the bill ultimately passed, and immunization rates increased. curbing opioid addiction needs more than new drugsas computers have improved, researchers have begun adapting agent-based models to look at sociological and behavioural trends that require more computing power because of the number of variables they contain. some groups use the technique for crisis modelling, and australia has begun intervention studies for child obesity on the basis of the findings of an agent-based model.in response to the opioid epidemic, bobashev’s group has constructed pain town — a generic city complete with 10,000 people suffering from chronic pain, 70 drug dealers, 30 doctors, 10 emergency rooms and 10 pharmacies. the researchers run the model over five simulated years, recording how the situation changes each virtual day.during this time, the patients’ drug tolerance increases, leading them to find different ways of acquiring drugs. their behaviour is driven by variables such as the chance that a doctor will increase their prescription, or the likelihood that a dealer will have enough heroin. at a certain threshold, patients become addicted or more likely to overdose. bobashev’s early data suggest, for example, that requiring doctors to track patients’ medication history can be effective over the long term, but not immediately3.the model contains many assumptions and simplifications, bobashev says. for example, it doesn’t capture the fact that the rate at which people develop tolerance and addiction can depend on factors such as genetics, and that whether a person switches from prescription drugs to heroin can depend on the relative availability of the two drugs.but researchers can adjust models such as pain town to test various interventions, such as increasing access to emergency rooms, arresting a dealer or equipping police with naloxone (a drug that reverses opioid overdoses), to see how the system reacts and whether it affects the number of deaths over time. and as models become more sophisticated, the researchers may be able to incorporate more factors, such as people who are not taking pain medications but are susceptible to trying opioids for the first time.models can also be useful for understanding why individual places or situations may differ, says christopher barrett, a computer scientist at virginia tech in blacksburg. for instance, heroin and fentanyl might be easier to come by in cities near ports, whereas doctors may be the main source of opioids in a suburban or rural setting. interventions focused on prescribing practices, therefore, would have different effects in each case. to treat pain, study people in all their complexitysuch models can also reveal feedback loops, such as the link between economic downturns and opioid use. some epidemiological studies have suggested that factors such as unemployment tend to predict suicide and addiction, especially in white male populations. and addiction can lead to further job loss and lower productivity, harming the economy. agent-based models could investigate loops such as this, providing ideas for how to mitigate the effects, barrett says.in may, bobashev and ciccarone presented results from one of their agent-based models at a meeting of the international society for the study of drug policy in vancouver, canada. their findings suggested that the increased prevalence of white-powder heroin — a newer form of the drug in the united states — may increase the risk of hiv spreading among injection drug users. the reason, also supported by the model, is that unlike black-tar heroin, users don’t need to heat the drug to dissolve it — and heating kills the virus.bobashev and ciccarone are working on models of how younger heroin users begin using the drug. unlike older users, who experienced the rise of the hiv epidemic in the 1980s, newer users may be less likely to adopt safe practices. the models suggest that the united states may see more localized hiv outbreaks, similar to the recent outbreak in scott county, indiana. that region experienced 181 new hiv cases between november 2014 and november 2015, compared with fewer than 5 cases per year previously. opioid use is thought to be the cause. agent-based models might help to stem future outbreaks by guiding surveillance priorities.law enforcement officials have been seizing vast quantities of heroin and the powerful synthetic drug fentanyl, but information on the amount in circulation is hard to come by.credit: drew angerer/gettyone of the most sophisticated agent-based models is the university of pittsburgh’s system, known as fred (a framework for reconstructing epidemiological dynamics). it fits population census data to maps of geographical regions around the country, allowing researchers to track virtual individuals in the area in a realistic way. it was data from these models that helped to convince pan and his fellow state senators to pass legislation on mandatory vaccination. the fred team is now beginning to use the system for opioid modelling, training it on historical trends. pan, who is also a physician, says he is intrigued by the prospect. if there’s a way to actually model in different communities which factors would have the biggest impact, that would be helpful, he says.the models face numerous challenges before they will be ready for widespread adoption, primarily data gaps. marshall says that researchers struggle to get access to data on opioid prescriptions that are held by manufacturers, pharmacies and law-enforcement agencies. it is also difficult to obtain government information on drug cartels and the type and rate of drugs flowing into the country. other data simply do not exist in usable form: agencies may record deaths due to drug overdose, for instance, but fail to specify which drug was responsible.observing drug users such as brandi can provide certain types of information more quickly and accurately. drug users know their chemicals intimately, ciccarone says.lee hoffer is a cultural anthropologist at case western reserve university in cleveland, ohio, who studies heroin markets and collaborates with bobashev. he says the ethnographic data that his group and others are collecting could help to fill some of the information gaps: we’re trying to enter their world as interlopers to see how they see their life. after an initial awkward period, he says, drug users tend to become more honest with the researchers, telling them crucial information such as how they form networks with dealers and the cost of drugs.understanding the psychology of drug users is also crucial, says epstein. most decision-making models assume rational behaviours. in reality, emotions, misinformation and irrational calculations play a major part. when you put them together you get collections of dynamics that are very dysfunctional. brain-protein structure could point way to safer prescription drugsepidemiological data may soon be available to buttress the models. the cdc and the us national institute on drug abuse have started several major surveys of drug-use patterns. a number of states have also begun collecting epidemiological information on trends in overdose and addiction. and research groups such as the university of pittsburgh team are working with multiple health agencies to collate their findings in a single database, which can inform fred and other models.but no matter how advanced the models become, implementing interventions based on their findings is an enormous challenge. models may reveal socioeconomic contributors that cannot be easily addressed by policies, and politics can stand in the way of proven solutions. in april, ciccarone had to cancel his work in charleston, at least for the time being, after a needle-exchange clinic with which he had been collaborating closed owing to political pressure. they were seeing 300 people on a wednesday afternoon because there’s a lot of need, he says. it’s a huge loss.increasing work is being done to determine the relative impact of interventions. the us national institutes of health (nih) in april announced $96 million for a programme that will partner with health-care systems and local governments to carry out evidence-based public-health interventions in different locations, evaluating them as they go. this is the first time this [has been] done for a particular substance-abuse disorder, says volkow. the nih is now asking researchers who want to apply for these funds to justify the size and scope of their proposed studies with data from models, including agent-based models.but these studies will take many years to complete. and bobashev says that society cannot afford to wait for the science to be perfect. by the time this data is collected, tens of thousands, if not hundreds of thousands, more deaths will have occurred.